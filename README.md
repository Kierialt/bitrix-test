# Скрипты для работы с Битрикс24 CRM

Этот набор скриптов позволяет работать с CRM Битрикс24 через REST API.

## Файлы проекта

- `BitrixAPI.php` - Основной класс для работы с API Битрикс24
- `create_contacts.php` - Создание 5 тестовых контактов
- `create_deals.php` - Создание 15 сделок с привязкой к случайным контактам
- `get_contacts_info.php` - Получение информации о контактах в формате JSON
- `run_all.php` - Скрипт для последовательного выполнения всех операций

## Настройка

1. Убедитесь, что у вас настроен веб-сервер (OpenServer, XAMPP или другой)
2. В файлах замените URL вебхука на ваш:
   ```php
   $webhookUrl = 'https://b24-und92u.bitrix24.ru/rest/1/1dh2605d0ed6g3q9/';
   ```

## Использование

### Вариант 1: Запуск всех операций сразу
```bash
php run_all.php
```

### Вариант 2: Пошаговое выполнение

1. Создание контактов:
```bash
php create_contacts.php
```

2. Создание сделок:
```bash
php create_deals.php
```

3. Получение информации о контактах:
```bash
php get_contacts_info.php
```

## Что делают скрипты

### create_contacts.php
- Создает 5 тестовых контактов с ФИО, телефоном и email
- Сохраняет ID контактов в файл `contact_ids.txt`

### create_deals.php
- Создает 15 сделок с случайными названиями и суммами
- Привязывает каждую сделку к случайному контакту
- Сохраняет ID сделок в файл `deal_ids.txt`

### get_contacts_info.php
- Возвращает JSON с информацией о всех контактах
- Включает ФИО, телефон, email, количество сделок и их ID

## Структура JSON ответа

```json
[
  {
    "id": "123",
    "name": "Иван Петров",
    "phone": "+7 (999) 123-45-67",
    "email": "ivan.petrov@example.com",
    "deals_count": 3,
    "deals": [
      {
        "id": "456",
        "title": "Продажа программного обеспечения",
        "amount": "150000",
        "currency": "RUB"
      }
    ]
  }
]
```

## Требования

- PHP 7.0 или выше
- Настроенный веб-сервер
- Действующий вебхук Битрикс24 с правами CRM


